define(["jquery","wechatSetup"],function(e,t){t.setup();var s;e.ajax({type:"GET",url:"//dev.cassiuschen.me/api/random.json",dataType:"json",async:!0,success:function(t,a){s=t,e(".main-text").html('<blockquote><b>"</b>'+t.content+'<b>"</b></blockquote>')}});var a,n=e("#mic");n.on("touchstart",function(){window.wechat.startRecord({success:function(){e("#mic").css("background-image","url(/assets/images/wave.gif)")}}),console.log("press")}),n.on("touchend",function(){window.wechat.stopRecord({complete:function(t){a=t.localId,e("#mic").css("background-image","url(/assets/images/mic.gif)")}}),setTimeout(function(){window.wechat.translateVoice({localId:a,complete:function(t){if(t.hasOwnProperty("translateResult")){var a=t.translateResult;e.ajax({type:"GET",url:"//dev.cassiuschen.me/api/diff?sentence_id="+s._id+"&string="+a,async:!1,dataType:"json",success:function(e,t){alert(e.rate),window.location.href="/result.html?rate="+parseInt(100*e.rate)}})}else alert("无法识别，请重新录音~！")}})},500)})});