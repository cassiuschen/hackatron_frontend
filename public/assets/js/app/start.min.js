define(["jquery","wechatSetup"],function(e,t){t.setup();var n;e.ajax({type:"GET",url:"//dev.cassiuschen.me/api/random.json",dataType:"json",async:!0,success:function(t,s){n=t,e(".main-text").html('<blockquote><b>"</b>'+t.content+'<b>"</b></blockquote>')}});var s,a=e("#mic");a.on("touchstart",function(){window.wechat.startRecord({success:function(){e("#mic").css("background-image","url(/assets/images/wave.gif)")}}),console.log("press")}),a.on("touchend",function(){window.wechat.stopRecord({complete:function(t){s=t.localId,e("#mic").css("background-image","url(/assets/images/mic.gif)")}}),setTimeout(function(){window.wechat.translateVoice({localId:s,complete:function(t){if(t.hasOwnProperty("translateResult")){var s=t.translateResult;e.ajax({type:"POST",url:"//dev.cassiuschen.me/api/diff",async:!1,contentType:"application/json",dataType:"json",data:JSON.stringify({string:s,sentence_id:n._id}),success:function(e,t){window.location.href="/result.html?rate="+parseInt(e.rate)}})}else alert("无法识别，请重新录音~！")}})},500)})});